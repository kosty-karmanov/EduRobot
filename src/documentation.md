# Образовательный набор: Колесный робот с лидаром

**Версия документации:** 1.0  
**Дата выпуска:** 2025  
**Автор:** Карманов Константин

---

## Содержание

- [Обзор](#обзор)
- [Особенности](#особенности)
- [Аппаратные характеристики](#аппаратные-характеристики)
- [Комплектация и список компонентов](#комплектация-и-список-компонентов)
- [Быстрый старт](#быстрый-старт)
  - [Сборка и подготовка робота](#сборка-и-подготовка-робота)
  - [Зарядка и питание](#зарядка-и-питание)
- [Настройка программного обеспечения](#настройка-программного-обеспечения)
  - [Настройка Raspberry Pi](#настройка-raspberry-pi)
  - [Настройка удалённого ПК](#настройка-удалённого-пк)
  - [Конфигурация сети](#конфигурация-сети)
- [Запуск базовых модулей](#запуск-базовых-модулей)
  - [Запуск Bringup робота](#запуск-bringup-робота)
  - [SLAM и построение карты](#slam-и-построение-карты)
  - [Телеприсвоение (Teleoperation)](#телеприсвоение-teleoperation)
- [Интеграция алгоритмов обучения с подкреплением](#интеграция-алгоритмов-обучения-с-подкреплением)
- [Расширенные настройки и советы по тюнингу](#расширенные-настройки-и-советы-по-тюнингу)
- [Часто задаваемые вопросы (FAQ)](#часто-задаваемые-вопросы-faq)
- [Ресурсы и поддержка](#ресурсы-и-поддержка)
- [Лицензирование и вклад](#лицензирование-и-вклад)

---

## Обзор

Данный набор разработан для обучения и практических экспериментов в области робототехники, автономной навигации и машинного обучения. Он идеально подходит для образовательных учреждений, исследовательских лабораторий и стартапов, которые стремятся изучать и разрабатывать современные алгоритмы, такие как SLAM, планирование маршрутов и адаптивное управление.

### Описание

Образовательный набор представляет собой аппаратную часть (робот, датчики, аккумуляторы) и программное обеспечение (ROS, алгоритмы SLAM, планирование маршрута, телеприсвоение). Наша цель – предоставить доступное и масштабируемое решение для тех, кто хочет глубже погрузиться в принципы работы современных роботов.

### Основные преимущества набора

- **Модульность конструкции:**  
  Легкость в сборке, разборке и модернизации компонентов позволяет быстро адаптировать систему под новые задачи.

- **Интеграция современных алгоритмов:**  
  В наборе реализованы базовые алгоритмы SLAM (например, Hector SLAM), глобальное планирование маршрута (A*) и локальное планирование (DWA). Дополнительно предусмотрена возможность интеграции методов обучения с подкреплением для адаптивного управления.

- **Открытость и масштабируемость:**  
  Документация и исходный код доступны на GitHub, что позволяет пользователям самостоятельно модифицировать и расширять функциональность системы.

- **Доступность:**  
  Использование отечественных и коммерчески доступных компонентов обеспечивает оптимальное соотношение цены и качества.

---

## Особенности

### Аппаратная часть

- **Одноплатный компьютер:**  
  Raspberry Pi 5 обеспечивает высокую производительность для обработки данных, работы с ROS и выполнения алгоритмов SLAM.

- **Контроллер:**  
  Arduino Nano отвечает за управление моторами и сбор данных с энкодеров, что позволяет обеспечить точное позиционирование и контроль движения робота.

- **Лидар:**  
  Delta2A – компактный лидар, способный измерять расстояния до 8 м с точностью менее 1% на 5 м. Он обеспечивает получение данных об окружающей среде в реальном времени.

- **Моторы:**  
  Компактные моторы Bringsmart GB12-N20B с энкодерами обеспечивают точное управление движением, позволяя реализовать как базовые, так и более сложные алгоритмы навигации.

- **Корпус:**  
  Тестовая версия изготовлена из PLA пластика для прототипирования, а финальная версия – из алюминиевого сплава 5052 для повышения прочности и долговечности.

### Программное обеспечение

- **ROS:**  
  Использование ROS1 (на Raspberry Pi с Ubuntu 16.04) позволяет интегрировать данные с датчиков и управлять роботом с помощью готовых пакетов и нод.

- **Симуляция и обучение:**  
  Поддержка симулятора Gazebo и интеграция с OpenAI Gym позволяют проводить обучение с подкреплением (RL), что дает возможность экспериментировать с адаптивным управлением роботом в динамических условиях.

- **Телеприсвоение и дистанционное управление:**  
  Модули телеприсвоения позволяют управлять роботом дистанционно через ROS-топики, что особенно полезно при построении карты и тестировании алгоритмов.

### Алгоритмическая часть

Наш набор не только демонстрирует работу аппаратных средств, но и предоставляет глубокое понимание алгоритмов:
- **SLAM (Simultaneous Localization and Mapping):**  
  Применяемый алгоритм Hector SLAM позволяет одновременно строить карту окружающей среды и определять положение робота, основываясь на данных с лидара. Этот метод не требует данных с одометра, что делает его устойчивым даже при небольших погрешностях.
  
- **Глобальное планирование (A*):**  
  Алгоритм A* используется для нахождения оптимального пути от текущего положения до заданной цели. Он оценивает стоимость пути с учетом препятствий, используя эвристическую функцию, что позволяет значительно ускорить поиск.
  
- **Локальное планирование (DWA):**  
  Dynamic Window Approach (DWA) обеспечивает адаптивное управление на коротких участках пути, реагируя на динамические изменения в окружении. DWA анализирует возможные команды управления и выбирает оптимальную, учитывая ограничения по скорости и безопасности.
  
- **Обучение с подкреплением (RL):**  
  Дополнительная возможность интеграции методов RL позволяет роботу самостоятельно учиться оптимальному поведению в сложных условиях. При обучении используются симуляции, где модель корректирует свои действия на основе получаемой награды, что помогает адаптироваться к изменяющейся среде.

---

## Аппаратные характеристики

| **Параметр**                         | **Значение / Модель**                       |
|--------------------------------------|---------------------------------------------|
| **Максимальная линейная скорость**   | ~0.3 м/с                                    |
| **Максимальная угловая скорость**    | ~3.0 рад/с                                  |
| **Габариты (Д×Ш×В)**                 | ~250×200×150 мм                             |
| **Вес (с компонентами)**             | ~1.5 кг                                     |
| **Питание**                          | 3×Li-Ion 18650 (11,1 В, ~38,8 Вт·ч)          |
| **Время работы**                     | ~1.5–2 часа (при среднем энергопотреблении)  |
| **Одноплатный компьютер (SBC)**      | Raspberry Pi 5                              |
| **Контроллер (MCU)**                 | Arduino Nano (подключён через USB)          |
| **Лидар**                            | Delta2A (дальность до 8 м, точность <1% на 5 м)  |
| **Моторы**                           | Bringsmart GB12-N20B (с энкодерами)          |
| **Интерфейсы подключения**           | USB, I2C, UART, GPIO                         |

---

## Комплектация и список компонентов

Образовательный набор поставляется в виде комплекта, включающего:

### Основные компоненты

- **Корпус робота:**
  - Три съемные части (верхняя, нижняя, боковые панели) с пазами для быстрой сборки.

- **Приводная система:**
  - 4 мотора Bringsmart GB12-N20B с энкодерами.
  - Крепеж для моторов и колес.

- **Электроника:**
  - **Raspberry Pi 5** с предустановленным Ubuntu 16.04 и ROS1 Kinetic.
  - **Arduino Nano**, подключённый по USB к Raspberry Pi для управления приводами и сбора данных с энкодеров.
  - **Лидар Delta2A** для сканирования окружающей среды.
  - Собственно разработанная печатная плата для драйверов моторов (на базе DRV8833 или аналог).

- **Питание:**
  - Три аккумулятора Li-Ion 18650 с модулем понижения напряжения.

- **Кабели и коннекторы:**
  - Провода для подключения датчиков, моторов и питания.
  - Кабели для USB и I2C-соединений.

- **Расходные материалы:**
  - Болты, гайки и другие крепежные элементы для сборки корпуса.

### Дополнительные аксессуары

- **3D-печатные крепления** для установки дополнительных датчиков.
- **Методические материалы** с примерами настройки, сборки и программирования.
- **Инструкции по обновлению ПО** и интеграции с симуляторами.

---

## Быстрый старт

Эта секция поможет вам быстро собрать и запустить робота для проведения первых экспериментов.

### Сборка и подготовка робота

1. **Распаковка:**  
   Извлеките все компоненты набора из упаковки и убедитесь, что все элементы присутствуют согласно комплектности.

2. **Сборка корпуса:**  
   - Соберите корпус, соединив верхнюю, нижнюю и боковые панели с помощью пазов и крепежных элементов.
   - Установите крепления для моторов и датчиков согласно прилагаемой схеме.

3. **Установка электроники:**  
   - Смонтируйте Raspberry Pi 5 и Arduino Nano на выделенные крепления внутри корпуса.
   - Подключите лидар Delta2A к соответствующему порту Raspberry Pi (через USB или UART).
   - Установите и закрепите моторы, подключив их к драйверной плате согласно электрической схеме.

4. **Подключение проводки:**  
   - Подключите провода питания, датчиков и энкодеров согласно инструкции.
   - Проверьте соединения, чтобы избежать коротких замыканий и обеспечить надежное крепление проводов.

### Зарядка и питание

1. **Подготовка аккумуляторов:**  
   - Убедитесь, что аккумуляторы Li-Ion 18650 заряжены (используйте прилагаемое зарядное устройство для первичной зарядки).
   - Подключите аккумуляторы к модулю понижения напряжения, установленному на роботе.

2. **Проверка питания:**  
   - После подключения аккумуляторов включите питание робота. Индикаторы на корпусе должны загореться, сигнализируя об инициализации системы.
   - Если индикаторы не активны, проверьте правильность подключения и измерьте напряжение на клеммах.

---

## Настройка программного обеспечения

Набор использует ROS для интеграции всех датчиков и управления роботом. В этой секции описаны шаги по настройке ПО как на самом роботе (Raspberry Pi), так и на удалённом ПК для мониторинга и управления.

### Настройка Raspberry Pi

1. **Установка операционной системы:**  
   - Вставьте SD-карту с образом Ubuntu 16.04, предварительно настроенным для ROS1 Kinetic.
   - При первом запуске выполните обновление системы:
     ```bash
     sudo apt update && sudo apt upgrade
     ```

2. **Настройка ROS:**  
   - Убедитесь, что ROS1 Kinetic установлен и все необходимые пакеты доступны.
   - Склонируйте репозиторий с исходным кодом робота:
     ```bash
     git clone https://github.com/kosty-karmanov/EduRobot.git
     ```
   - Запустите тестовый launch-файл для проверки работы датчиков:
     ```bash
     roslaunch edu_robot bringup.launch
     ```

3. **Проверка периферии:**  
   - Проверьте, что лидар передает данные (подпишитесь на топик `/scan`).
   - Убедитесь, что данные одометрии с Arduino Nano публикуются в топике `/odom`.

### Настройка удалённого ПК

1. **Установка Ubuntu и ROS:**  
   - Рекомендуется использовать Ubuntu 20.04 LTS. Установите ROS1 Noetic или ROS2 Humble, в зависимости от ваших потребностей.
   - Обновите систему:
     ```bash
     sudo apt update && sudo apt upgrade
     ```
   - Установите основные ROS-пакеты:
     ```bash
     sudo apt install ros-noetic-joy ros-noetic-teleop-twist-keyboard ros-noetic-rviz ros-noetic-gmapping ros-noetic-move-base
     ```

2. **Настройка сети и переменных окружения:**  
   - Узнайте IP-адрес вашего ПК с помощью команды:
     ```bash
     ifconfig
     ```
   - Откройте файл `~/.bashrc` и добавьте следующие строки, заменив `IP_АДРЕС_ПК` на реальный адрес:
     ```bash
     export ROS_MASTER_URI=http://IP_АДРЕС_ПК:11311
     export ROS_HOSTNAME=IP_АДРЕС_ПК
     ```
   - Сохраните файл и выполните:
     ```bash
     source ~/.bashrc
     ```

### Конфигурация сети

1. **Подключение к Wi-Fi:**  
   - На Raspberry Pi отредактируйте файл `/etc/wpa_supplicant/wpa_supplicant.conf`, добавив данные вашей сети.
   - Перезагрузите систему для применения настроек.

2. **Проверка соединения:**  
   - С удалённого ПК выполните команду `ping` до IP-адреса Raspberry Pi для проверки сетевого доступа.

---

## Запуск базовых модулей

### Запуск Bringup робота

1. **Запуск roscore:**  
   На удалённом ПК выполните:
   ```bash
   roscore
   ```
2. **Запуск нод робота:**  
   Подключитесь по SSH к Raspberry Pi и запустите основной Bringup:
   ```bash
   ssh pi@IP_АДРЕС_RPI
   roslaunch edu_robot bringup.launch
   ```
   Убедитесь, что все датчики и исполнительные устройства активны.

### SLAM и построение карты

1. **Запуск SLAM-ноды:**  
   Для построения карты используется Hector SLAM. С удалённого ПК выполните:
   ```bash
   roslaunch edu_robot slam.launch
   ```
2. **Мониторинг карты:**  
   - Откройте RViz на удалённом ПК:
     ```bash
     rosrun rviz rviz
     ```
   - Добавьте отображение карты (Occupancy Grid) и следите за обновлениями, пока робот перемещается по рабочему пространству.

### Телеприсвоение (Teleoperation)

1. **Запуск телеприсвоения:**  
   Для дистанционного управления роботом откройте новый терминал на удалённом ПК и выполните:
   ```bash
   roslaunch edu_robot teleop.launch
   ```
2. **Управление роботом:**  
   Используйте клавиатуру для управления движением:
   - **W/S** – увеличение/уменьшение линейной скорости
   - **A/D** – увеличение/уменьшение угловой скорости
   - **Пробел / S** – экстренная остановка  
   Следуйте инструкциям, отображаемым в терминале.

---

## Интеграция алгоритмов обучения с подкреплением

Набор поддерживает интеграцию методов обучения с подкреплением (RL) для адаптивного управления роботом в динамических условиях.

### Основные этапы интеграции:

1. **Создание симуляционного окружения:**  
   - Используйте Gazebo и OpenAI Gym для моделирования поведения робота.
   - Определите состояние окружения (линейная и угловая скорость, данные с лидара) и функцию награды, которая будет стимулировать робота к приближению к целевой точке и избеганию столкновений.

2. **Обучение модели:**  
   - Запустите параллельные симуляции для ускорения процесса обучения.
   - Настройте нейронную сеть с использованием TensorFlow или PyTorch для обработки входных данных и принятия решений.
   - Контролируйте процесс обучения, корректируя параметры награды и скорость обучения, чтобы модель адаптировалась к разнообразным сценариям.

3. **Перенос на реальное устройство:**  
   - После стабилизации поведения модели в симуляции перенесите обученную модель на Raspberry Pi.
   - Проведите дополнительную калибровку модели с учетом реальных условий эксплуатации, так как симуляция не всегда полностью отражает физическую среду.

---

## Расширенные настройки и советы по тюнингу

### Настройка SLAM

- **Параметры лидар-сенсора:**  
  Отрегулируйте параметр `maxUrange` в конфигурационном файле SLAM, чтобы задать максимальное допустимое расстояние измерения, оптимальное для вашего рабочего пространства.

- **Интервал обновления карты:**  
  Параметр `map_update_interval` определяет, как часто будет обновляться карта. Слишком частое обновление может привести к увеличению нагрузки на процессор, а слишком редкое — к потере детализации.

- **Порог сопоставления сканов:**  
  Параметр `minimumScore` помогает снизить вероятность ошибок в определении положения робота, особенно в условиях слабых или шумных данных с лидара.

### Тюнинг телеприсвоения

- **Регулировка отклика:**  
  Настройте параметры изменения линейной и угловой скорости в конфигурационных файлах ноды телеприсвоения, чтобы обеспечить плавное и предсказуемое управление роботом.

- **Защита механики:**  
  Рекомендуется установить программные ограничения на резкие изменения команд движения, что поможет защитить механические компоненты от износа и повреждений.

### Советы по отладке

- **Мониторинг топиков:**  
  Используйте команду `rostopic echo` для просмотра данных с датчиков и проверки корректности публикации сообщений.

- **Использование RViz:**  
  Настройте отображение TF, одометрии и данных лидара в RViz для визуального контроля над работой робота и своевременной диагностики проблем.

- **Логирование:**  
  Включите подробное логирование в конфигурации ROS, что позволит отслеживать ошибки и оптимизировать работу нод.

---

## Часто задаваемые вопросы (FAQ)

**Вопрос:** Что делать, если робот не соединяется с Wi-Fi?  
**Ответ:** Проверьте настройки файла `/etc/wpa_supplicant/wpa_supplicant.conf`, убедитесь, что введены корректные SSID и пароль. Перезагрузите систему и проверьте соединение с помощью команды `ifconfig`.

**Вопрос:** Робот не публикует данные с лидара, что предпринять?  
**Ответ:** Проверьте правильность подключения лидара (USB/UART) и установку драйверов. Используйте `rostopic echo /scan` для диагностики.

**Вопрос:** При запуске SLAM-ноды карта не обновляется.  
**Ответ:** Убедитесь, что робот активно перемещается и данные одометрии корректно публикуются. Проверьте параметры конфигурации Hector SLAM.

**Вопрос:** Как обновить программное обеспечение робота?  
**Ответ:** Исходный код и обновления доступны на GitHub. Следуйте инструкциям по клонированию репозитория и сборке пакетов через catkin.

**Вопрос:** Где найти дополнительные примеры и методические материалы?  
**Ответ:** Примеры и инструкции доступны в репозитории [GitHub/EduRobot](https://github.com/kosty-karmanov/EduRobot) и в документации, прилагаемой к набору.

---

## Ресурсы и поддержка

- **GitHub:**  
  [https://github.com/your-repo/EduRobot](https://github.com/kosty-karmanov/EduRobot)  
  Здесь вы найдёте исходный код, обновления и инструкции по сборке.

- **Форум поддержки:**  
  Посетите наш форум для обмена опытом, получения советов по настройке и устранению неполадок.

- **Видео-инструкции:**  
  Обучающие видео по сборке, настройке и эксплуатации робота доступны на нашем YouTube-канале.

- **Документация по ROS:**  
  Официальная документация ROS ([ros.org](https://www.ros.org/)) поможет разобраться в работе используемых пакетов.
